%!TEX root = ../dokumentation.tex

\chapter{Analyse}
Bevor es an die tatsächliche Realisierung des Projektes geht, müssen zunächst
bestehende Bibliotheken und Technologien auf ihre Nutzbarkeit im Bezug auf das
Projekt analysiert werden. 

%comment: evtl nen Raspberry Editionen verleich hinzufügen

\section{Einarbeitung}
Bevor es an die Realisierung der Aufgabe geht, steht zunächst das
Vertrautmachen mit den unterschiedlichen Technologien im Vordergrund. Für die
Entwicklung wurde eine Raspberry Pi 3 Modell B bereitgestellt. Da das zu
entwickelnde Programm später auf dem gleichen Modell laufen wird, wird auf
einen Vergleich der veschiedenen Modelle verzichtet. Bevor der Raspberry
benutzt werden kann, muss zunächst ein Betriebssystem installiert werden.
\hfill \break

Für den Raspberry Pi gibt es verschiedene Distributionen, die auf verschiedene
Anwendungsszenarien ausgelegt sind. Nachfolgend sind ein paar der verfügbaren
Betriebssystem aufgelistet: 
\begin{description}
\item[Raspbian] \hfill \\ 
    Raspbian ist eines der ältesten und meistverbreitetsten Betriebssysteme für
    den Raspberry Pi. 
\item[Pi MusicBox] \hfill \\ 
    Bei der Pi MusicBox handelt es sich um eine Distribution, welche auf das
    Abspielen von Musik ausgelegt ist. Es unterstützt alle bewährten
    Streaming-Dienste oder auch das Streamen von Musik aus dem Netzwerk.
\item[RetroPie] \hfill \\
    Der RetroPie ist eine Distribution, welche das Emulieren von klassischen
    Spielekonsolen ermöglicht.
\end{description}

Im Rahmen dieser Arbeit steht zwar das Abspielen von Musik im Vordergrund,
allerdings soll dabei nicht auf bestehende Tools zurückgegriffen werden,
sondern eine eigenständige Lösung entwickelt werden. Da es für den Raspbian 
Im Rahmen dieser Arbeit geht es zwar um das Abspielen von Musik, allerdings
soll dafür ein eigenständiges Tool entwickelt werden. Da Raspbian das
offizielle Betriebssystem für den Raspberry Pi ist, es am verbreitetsten ist
und es dafür die meisten Pakete gibt, wird sich im Bezug auf diese Arbeit für
das Betriebssystem Raspbian entschieden.


\section{Abspielen der Musik}
Um bei der Umsetzung nicht komplett von Null anfangen zu müssen, geht es
zunächst an die Analyse einer geeigneten Audio Bibliothek, um das Abspielen von
Audiodateien zu ermöglichen. Dabei ist es wichtig, dass die Biblitohek frei zu
verwenden, gut dokumentiert ist und eine Schnittstelle für Go besitzt.  Im
ersten Schritt der Analyse geht es an die Entscheidung einer geeigneter Audio
Bibliothek, um das Abspielen von Audiodateieen zu ermöglichen. Wichtig dabei
ist, dass die Bibliothek keine Einschränkungen bei der Benutzung hat, gut
dokumentiert ist und dass die Bibliothek bestenfalls eine bestehende
Schnittstelle für Go besitzt.
\subsection{Bibliotheken}
\paragraph{PortAudio}
PortAudio ist eine Open Source Bibliothek, welche das Abspielen und Aufnehmen
von Audiodateien ermöglicht. Sie bietet eine plattformübergreifende Lösung,
wodurch sie auf den gängisten Betriebssystemen problemlos läuft. Einer der
Gründ dafür, dass sie plattformübergreifend funktioniert, ist der, dass
PortAudio in der Programmiersprache C geschrieben wurde. \hfill \break

Die Kommunikation mit PortAudio verläuft über eine \ac{API} Schnittstelle.
Diese entnimmt den Datenstrom entgegen, welche abgespielt werden soll. Während
des Abspiel- oder Aufnahmprozesses von Audiodateien benutzt PortAudio entweder
eine Callback-Funktion oder einen blockierendes Read/Write Interface.
\href{http://www.portaudio.com/}{Portaudio}

\paragraph{libsoundio}
libsoundio ist eine Audio-Input und -Output Schnittstelle, welche sich zum Abspielen
von Audiodateien eignet. 
- Plattformübergreifend
- gut dokumentiert
- lightweight abstraction over varius sound drivers


Es zeichnet sich durch seine leichtgewichtige
Abstraktion über mehrere Soundtreiber aus
Libsoundio ist eine leichtgewichtige Abstrakiton über verschiedene Soundtreiber. 

\paragraph{JACK}
JACK ist ein Audioserver mit geringer Latenzzeit. 
JACK ist ein Audioserver, welcher 
JACK ist ein Audioserver, welcher sich durch seine niedrige Latenzzeiten 
JACK -> Audioserver
- geringe Latenzzeiten
- sound server daemon
- Verbindung über API
- Open Source Projekt
- free software unter GNU GPLkk

\subsection{Entscheidung}
Auf den meisten Linux-Systemen ist PuleAudio
PortAudio erfüllt alle zuvor definierten Voraussetzungen. Es gibt sogar eine
gleichnamige in Go implementierte Bibliothek, welche im Hintergrund auf die
Schnittstellen von PortAudio zurückgreift. So muss bei der späteren Entwicklung
lediglich auf die Funktionen dieser Bibliothek zurückgegriffen werden, und sich
keine Gedanken über die Anbindung mit PortAudio gemacht werden. 

\section{MP3 Decoder}
go-mpg123 is a library that provides bindings to libmpg123.
Not all library functions are present, but there are enough bindings to decode an MP3 file using mpg123-open and mpg123-read. However, decoding from a file reader and feeding data directly to the decoder are not yet supported. Seeking and meta-data reading are also not yet supported.
This library is still very much a work in progress.

\href{https://github.com/bobertlo/go-mpg123}{MP3 Decoder}

\section{MP3 Tag Info Reader}
Hier kommt der Scheiß ist zustand rein

ID3 (engl. identify an MP3 „identifiziere eine MP3“) ist ein Format für Zusatzinformationen (Metadaten), die in Audiodateien des MP3-Formats enthalten sein können. Die einzelnen Informationseinheiten werden ID3-Tag genannt (engl. tag „Etikett“).

Bevor es ID3-Tags für Informationen wie den Namen des Albums, des Künstlers oder des Musik-Stils gab, musste der Datei- oder Verzeichnisname diese Angaben aufnehmen. Die Folge waren sehr lange Dateinamen und daher unübersichtliche Verzeichnisse. Ferner eignen sich Dateisysteme oft nicht für alle Sonderzeichen, die für manche Titel, Interpreten oder Albennamen nötig sind, sowie für die Länge der benötigten Dateinamen; auch unterscheiden sich oft die Zeichenkodierungen, zum Beispiel ISO 8859 und Unicode, Sonderzeichen wurden zwischen den verschiedenen code pages von ISO 8859 falsch interpretiert oder die Dateinamen werden bei der Übertragung über ein Netzwerk (genauer durch die Protokolle oder deren Implementierungen) verfälscht.

Deshalb entschloss man sich, diese Metadaten in einem reservierten Teil der Audiodateien unterzubringen.

In Anlehnung an ID3 entwickelte sich ein ähnliches Verfahren für Bilddateien im JPEG-Format, welche das Datum und ähnliche Informationen, die Exif-Information, enthalten.

\href{https://github.com/mikkyang/id3-go}{ID3 Decoder}
